<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K3D Plot Viewer</title>
    <style>
        /* Overall layout */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Left panel */
        .left-content {
            flex: 1;
            padding: 20px;
            background-color: #f8f8f8;
            display: flex;
            flex-direction: column;
        }

        /* Dropdown menus */
        .dropdown {
            margin-bottom: 15px;
        }

        select {
            width: 100%;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        /* List of items */
        .item-list {
            flex: 1;
            overflow-y: auto;
        }

        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 10px;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Right panel */
        .iframe-container {
            flex: 2;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #ffffff;
        }

        iframe {
            width: 95%;
            height: 95%;
            border: none;
        }
    </style>
    <div class="container">
        <button class="nav-button" onclick="navigate('download')">Download</button>
        <button class="nav-button" onclick="navigate('tutorials')">Tutorials</button>
    </div>

    <script>
        function navigate(page) {
            // In a real application, you would replace these with actual URLs
            const pages = {
                'download': 'download.html',
                'tutorials': 'tutorials.html'
            };
            
            window.location.href = pages[page];
        }
    </script>
</head>
<body>
    <div class="left-content">
        <h2>Search Plots</h2>
        <div class="dropdown">
            <label for="classFilter">Class:</label>
            <select id="classFilter" onchange="filterItems()">
                <option value="">All Classes</option>
            </select>
        </div>
        <div class="dropdown">
            <label for="timeFilter">Timepoint:</label>
            <select id="timeFilter" onchange="filterItems()">
                <option value="">All Timepoints</option>
            </select>
        </div>
        <div class="item-list" id="itemList">
            <!-- Buttons will be dynamically added here -->
        </div>
    </div>

    <div class="iframe-container">
        <iframe id="iframe" src="about:blank"></iframe>
    </div>

    <script>
        // Metadata for plots
        const metadata = [
            { name: "PC 30:0", file: "data_html/test_plot.html", class: "PC", timepoint: "72 hpf" },
            { name: "PC 34:2", file: "data_html/test_plot.html", class: "PC", timepoint: "72 hpf" },
            { name: "PE 30:1", file: "data_html/test_plot.html", class: "PE", timepoint: "48 hpf" },
            { name: "PG 30:1", file: "data_html/test_plot.html", class: "PG", timepoint: "8 hpf" },
            { name: "PC 30:5", file: "data_html/test_plot.html", class: "PC", timepoint: "24 hpf" }
        ];

        // Populate dropdown menus with unique values
        function populateDropdowns() {
            const classSet = new Set(metadata.map(item => item.class));
            const timeSet = new Set(metadata.map(item => item.timepoint));

            const classFilter = document.getElementById('classFilter');
            const timeFilter = document.getElementById('timeFilter');

            // Populate Class dropdown
            classSet.forEach(cls => {
                const option = document.createElement('option');
                option.value = cls.toLowerCase();
                option.textContent = cls;
                classFilter.appendChild(option);
            });

            // Populate Timepoint dropdown
            timeSet.forEach(time => {
                const option = document.createElement('option');
                option.value = time.toLowerCase();
                option.textContent = time;
                timeFilter.appendChild(option);
            });
        }

        // Create buttons for each plot
        function createButtons() {
            const itemList = document.getElementById('itemList');
            itemList.innerHTML = ''; // Clear the list
            metadata.forEach((item) => {
                const button = document.createElement('button');
                button.textContent = `${item.name} (Class: ${item.class}, Time: ${item.timepoint})`;
                button.onclick = () => updateIframe(item.file);
                button.dataset.class = item.class.toLowerCase();
                button.dataset.timepoint = item.timepoint.toLowerCase();
                itemList.appendChild(button);
            });
        }

        // Update the iframe to show selected plot
        function updateIframe(url) {
            document.getElementById('iframe').src = url;
        }

        // Filter items based on dropdown selections
        function filterItems() {
            const classFilter = document.getElementById('classFilter').value.toLowerCase();
            const timeFilter = document.getElementById('timeFilter').value.toLowerCase();
            const buttons = document.querySelectorAll('#itemList button');

            buttons.forEach((button) => {
                const matchesClass = !classFilter || button.dataset.class === classFilter;
                const matchesTime = !timeFilter || button.dataset.timepoint === timeFilter;
                button.style.display = matchesClass && matchesTime ? 'block' : 'none';
            });
        }

        // Initialize the page
        populateDropdowns();
        createButtons();
    </script>
</body>
</html>